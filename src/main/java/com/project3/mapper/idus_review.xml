<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
<mapper namespace = "mapper.review">
	<insert id = "register" parameterType  = "com.project3.vo.IdusReviewVO">
		INSERT INTO IDUS_REVIEW 
		VALUES('r_'||idus_review_seq.nextval,#{pid},#{uemail},'',#{rfile},#{rsfile},#{rcontent},#{rscore},sysdate)
	</insert>  

	<select id="count" resultType="java.lang.Integer">
		select count(*) from idus_review
	</select>
	
	<select id="list" parameterType="map" resultType="com.project3.vo.IdusReviewVO">
		select * from (select rownum rno, r.rid, r.pid, p.ptitle, r.uemail, r.oid, r.rfile, r.rsfile,p.psfile1, r.rcontent, r.rscore, to_char(r.rdate, 'yyyy.mm.dd') rdate 
		from (select * from idus_review order by rdate desc) r, idus_product p where r.pid=p.pid) where rno between #{start} and #{end}
	</select>
	
	<select id="content" parameterType="java.lang.String" resultType="com.project3.vo.IdusReviewVO">
		select r.rid, r.pid, p.ptitle, r.uemail, r.oid, r.rfile, r.rsfile, r.rcontent, r.rscore, to_char(r.rdate, 'yyyy.mm.dd') rdate 
		from idus_review r, idus_product p where r.pid=p.pid and rid=#{id}
	</select>
	
	<delete id="deleteAll">
		delete from idus_review
	</delete>
	
	<delete id="delete" parameterType="java.lang.reflect.Array">
		delete from idus_review where rid in
		
		<foreach item="item" index="index" collection="array"
	      open="(" separator="," close=")">
	      #{item}
	    </foreach>
	</delete>
</mapper>